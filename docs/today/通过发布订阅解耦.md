---
title: 通过发布订阅解耦
timeline: true
subtitle: "Vue 工程"
tags: ["前端", "小计"]
time: "2025-11-12 12:03:26"
description: ""
---

# 通过发布订阅解耦

> [参考](https://www.bilibili.com/list/watchlater/?bvid=BV1DNymB8Ety&oid=115456119669982&watchlater_cfg=%7B%22viewed%22%3A0,%22key%22%3A%22%22,%22asc%22%3Afalse%7D&spm_id_from=333.881.0.0)

<h4 id="PsP0o"> 一、 开发中遇到的问题</h4>

1. **通信模块(axios)**中存在其他耦合模块，比如**弹窗组件、路由组件**
   1. **思考下自己的项目中是否有根据状态码执行不同的逻辑**
      1. **非 200 执行弹窗 message**
      2. **404 执行 路由跳转**
      3. **退出状态码 -> 清空 token、localstorge、 sessionStorge**
      4. **token 过期 -> xx**
2. 各个模块有自己的职责，如果内容多了会导致耦合严重问题。 整个页面非常杂乱
3. 解决方式
   1. 把动态多变的抽离到一个新的文件。比如**状态码**
   2. 通过发布订阅模式解耦
      1. 优势：
         1. 各个模块非常的干净，易读。适合长期维护。
         2. 业务多变只要符合当前规范，也很容易维护。
      2. 劣势：
         1. 从集中处理到打散，不好理解(阵痛)

<h4 id="hUrDn">二、 发布订阅模式解耦(中间层)</h4>

> 可以使用 mitt

![图片1](https://cdn.nlark.com/yuque/0/2025/jpeg/320786/1762920012795-16f9af9f-792d-45d5-853a-85738356392a.jpeg)

![图片2](https://cdn.nlark.com/yuque/0/2025/jpeg/320786/1762920006124-4ff1e993-5d2e-436a-baf1-97e430f4e83c.jpeg)

```typescript
import  createRouter, createWebHashHistory } from'vue-router';
import emitter from './eventEmitter';

const router = createRouter({
  history: createWebHashHistory(),
  routes: []
})

emitter.on('API:UN_AUTH', () => {
    router.push('/login')
})

export default router;
```
